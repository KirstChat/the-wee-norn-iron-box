{% extends "base.html" %}
{% load static %}

{% block page_heading %}
    <!-- Image & CTA Button -->
    <section class="white-container p-4">
        <div class="container">
            <div class="row">
                <!-- Products Button -->
                <div class="col-md-12 col-lg-5 order-2 order-lg-1 text-center align-self-center">
                    <h1>The Taste of Home in a Wee Box</h1>
                    {% if request.user.is_authenticated %}
                        <a class="btn my-4 py-2 px-4" href="{% url 'products' %}">Our Wee Products</a>
                    {% else %}
                        <a class="btn my-4 py-2 px-4" href="{% url 'account_signup' %}">Get Started</a>
                    {% endif %}
                </div>
                <!-- Box Mock Up Image -->
                <div class="col-md-12 col-lg-7 order-sm-1 align-self-end">
                    <img class="img-fluid" src="{% static "images/box-mock-up.jpg" %}" alt="Box Mock Up">
                </div>
            </div>
        </div>
    </section>
{% endblock %}

{% block content %}
    <!-- How It Works-->
    <section class="yellow-container steps p-4">
        <div class="container text-center">
            <h2>How it Works</h2>
            <p class="mt-2 mb-4">
                We'll deliver your favourite Northern Irish goods in a Wee Box all for Â£10!
            </p>
            <!-- Steps -->
            <div class="row g-4 steps">
                <!-- Account -->
                <div class="col-md-12 col-lg-4">
                    <div class="card border-0 h-100 p-4">
                        <i class="fas fa-box mb-4"></i>
                        <p class="fw-bold">
                            All you need to do is sign up for an account to start adding your favourite items to your box
                        </p>
                        <p>
                            Click the <span class="fw-bold">Sign Up</span> button below to sign up for an account
                            now
                        </p>
                    </div>
                </div>
                <!-- Payment -->
                <div class="col-md-12 col-lg-4">
                    <div class="card border-0 h-100 p-4">
                        <i class="fas fa-credit-card mb-4"></i>
                        <p class="fw-bold">
                            Once you've filled up your box, simply pay for your box and tell us where to send it
                        </p>
                        <p>
                            Box items are limited to
                            <br>
                            2 x Breads, 2 x Drinks and 2 x Snacks
                        </p>
                    </div>
                </div>
                <!-- Delivery -->
                <div class="col-md-12 col-lg-4">
                    <div class="card border-0 h-100 p-4">
                        <i class="fas fa-truck mb-4"></i>
                        <p class="fw-bold">
                            We'll quickly deliver your box to you at no extra cost
                        </p>
                        <p>
                            All baked goods are delivered fresh so you won't need to worry about expiry dates
                        </p>
                    </div>
                </div>
            </div>
            <!-- Admin/Registered User Button -->
            {% if request.user.is_superuser %}
                <a class="btn mt-4 py-2 px-4" href="#">Product Admin</a>
            {% elif request.user.is_authenticated %}
                <a class="btn mt-4 py-2 px-4" href="{% url 'view_box' %}">My Box</a>
            {% else %}
                <a href="{% url 'account_signup' %}" class="btn mt-4 py-2 px-4">Sign Up</a>
            {% endif %}
        </div>
    </section>

    <!-- Testimonials -->
    <section class="white-container">
        <div class="container p-4 text-center">
            <h3 class="mb-4">Here's what our subscribers think</h2>
            <!-- Review Carousel -->
            <div class="row">
                {% for review in reviews %}
                    <div class="col-lg-4">
                        <div class="card border-0 h-100">
                            <div class="card-header fw-bold">
                                {{ review.title }}
                            </div>
                            <div class="card-body">
                                <p>{{ review.review }}</p>
                                <p class="star-rating">{{ review.rating }}</p>
                                <p class="fst-italic mt-3">Posted By: {{ review.posted_by }}</p>
                            </div>
                        </div>
                    </div>
                {% endfor %}
            </div>
            <!-- Add Review -->
            {% if request.user.is_authenticated %}
                <a href="{% url 'add_review' %}" class="btn mt-4 py-2 px-4">Add Review</a>
            {% endif %}
        </div>
    </section>
{% endblock %}

{% block postloadjs %}
{{ block.super }}   
    <script>
        const starRating = document.querySelectorAll('.star-rating');

        starRating.forEach(rating => {
            if (rating.innerText === "5") {
                rating.innerHTML = `
                    <i class="fas fa-star"></i>
                    <i class="fas fa-star"></i>
                    <i class="fas fa-star"></i>
                    <i class="fas fa-star"></i>
                    <i class="fas fa-star"></i>`
            } else if (rating.innerText === "4") {
                rating.innerHTML = `
                    <i class="fas fa-star"></i>
                    <i class="fas fa-star"></i>
                    <i class="fas fa-star"></i>
                    <i class="fas fa-star"></i>`
            } else if (rating.innerText === "3") {
                rating.innerHTML = `
                    <i class="fas fa-star"></i>
                    <i class="fas fa-star"></i>
                    <i class="fas fa-star"></i>`
            } else if (rating.innerText === "2") {
                rating.innerHTML = `
                    <i class="fas fa-star"></i>
                    <i class="fas fa-star"></i>`
            } else {
                rating.innerHTML = `<i class="fas fa-star"></i>`
            };
        });
    </script>
{% endblock %}